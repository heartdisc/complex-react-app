"use strict";(self.webpackChunkcomplex_react_app=self.webpackChunkcomplex_react_app||[]).push([[80],{80:(e,a,t)=>{t.r(a),t.d(a,{default:()=>i});var s=t(540),r=t(343),c=t(306),l=t(643),n=t(976);const m=(0,t(115).Ay)("http://localhost:8080"),i=function(){const e=(0,s.useContext)(r.A),a=(0,s.useContext)(c.A),t=(0,s.useRef)(null),i=(0,s.useRef)(null),[o,u]=(0,l.e)({fieldValue:"",chatMessages:[]});return(0,s.useEffect)((()=>{e.isChatOpen&&(t.current.focus(),a({type:"clearUnreadChatCount"}))}),[e.isChatOpen]),(0,s.useEffect)((()=>{m.on("chatFromServer",(e=>{u((a=>{a.chatMessages.push(e)}))}))}),[]),(0,s.useEffect)((()=>{i.current.scrollTop=i.current.scrollHeight,o.chatMessages.length&&!e.isChatOpen&&a({type:"increamentUnreadChatCount"})}),[o.chatMessages]),s.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(e.isChatOpen?"chat-wrapper--is-visible":"")},s.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",s.createElement("span",{onClick:()=>a({type:"closeChat"}),className:"chat-title-bar-close"},s.createElement("i",{className:"fas fa-times-circle"}))),s.createElement("div",{id:"chat",className:"chat-log",ref:i},o.chatMessages.map(((a,t)=>a.username==e.user.username?s.createElement("div",{className:"chat-self"},s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},a.message)),s.createElement("img",{className:"chat-avatar avatar-tiny",src:a.avatar})):s.createElement("div",{className:"chat-other"},s.createElement(n.N_,{to:`/profile/${a.username}`},s.createElement("img",{className:"avatar-tiny",src:a.avatar})),s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},s.createElement(n.N_,{to:`/profile/${a.username}`},s.createElement("strong",null,a.username,":")),a.message)))))),s.createElement("form",{onSubmit:function(a){a.preventDefault(),m.emit("chatFromBrowser",{message:o.fieldValue,token:e.user.token}),u((a=>{a.chatMessages.push({message:a.fieldValue,username:e.user.username,avatar:e.user.avatar}),a.fieldValue=""}))},id:"chatForm",className:"chat-form border-top"},s.createElement("input",{onChange:function(e){const a=e.target.value;u((e=>{e.fieldValue=a}))},ref:t,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off",value:o.fieldValue})))}}}]);